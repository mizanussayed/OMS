<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:components="clr-namespace:OMS.Components"
    xmlns:vm="clr-namespace:OMS.ViewModels"
    x:DataType="vm:EmployeesViewModel"
    x:Class="OMS.Pages.EmployeesPage"
    Title="Employees"
    BackgroundColor="{StaticResource Gray50}"
    Shell.NavBarIsVisible="False">

	<Grid RowDefinitions="Auto,*">
		<components:GradientHeader Grid.Row="0"
                Title="Employees"
                Subtitle="Manage your team members"
                ActionButtonIcon="icon_plus.svg"
                ActionButtonText="Add Employee"
                ShowActionButton="True"
                ActionButtonCommand="{Binding ShowAddEmployeeCommand}"/>

		<RefreshView Grid.Row="1"
                     IsRefreshing="{Binding IsRefreshing}"
                     Command="{Binding LoadDataCommand}">
			<CollectionView ItemsSource="{Binding Employees}">
				<CollectionView.ItemTemplate>
					<DataTemplate x:DataType="vm:EmployeeItemViewModel">
						<Border Padding="16"
								StrokeThickness="0"
								BackgroundColor="{StaticResource White}"
								Margin="0,0,0,12">
							<Border.StrokeShape>
								<RoundRectangle CornerRadius="12" />
							</Border.StrokeShape>
							<Border.Shadow>
								<Shadow Brush="{StaticResource Gray900}"
										Opacity="0.08"
										Radius="10"
										Offset="0,2" />
							</Border.Shadow>

							<Grid ColumnDefinitions="Auto,*,Auto">
								<Border Grid.Column="0"
										WidthRequest="56"
										HeightRequest="56"
										BackgroundColor="{StaticResource White}"
										StrokeThickness="0"
										VerticalOptions="Center">
									<Border.StrokeShape>
										<RoundRectangle CornerRadius="28" />
									</Border.StrokeShape>
									<Label Text="{Binding InitialsDisplay}"
										   FontSize="20"
										   FontAttributes="Bold"
										   TextColor="{StaticResource White}"
										   HorizontalOptions="Center"
										   VerticalOptions="Center"/>
								</Border>

								<VerticalStackLayout Grid.Column="1"
													Spacing="4"
													Margin="16,0,0,0"
													VerticalOptions="Center">
									<Label Text="{Binding Name}"
										   FontSize="16"
										   FontAttributes="Bold"
										   TextColor="{StaticResource Gray900}"/>
									<Label Text="{Binding Username}"
										   FontSize="14"
										   TextColor="{StaticResource Gray600}"/>
									<HorizontalStackLayout Spacing="4">
										<Label Text="??"
											   FontSize="12"
											   FontFamily="{OnPlatform Android='sans-serif', iOS='Arial'}"
											   VerticalOptions="Center"/>
										<Label Text="{Binding MobileNumber}"
											   FontSize="13"
											   TextColor="{StaticResource Gray600}"/>
									</HorizontalStackLayout>
								</VerticalStackLayout>
							</Grid>
						</Border>
					</DataTemplate>
				</CollectionView.ItemTemplate>
				<CollectionView.EmptyViewTemplate>
                    <DataTemplate>
                        <Label IsVisible="{Binding HasNoEmployees}"
                                   Text="No employees yet. Add team member first!"
								   FontSize="16"
								   TextColor="{StaticResource Gray500}"
								   HorizontalOptions="Center"
								   VerticalOptions="Center"/>
                    </DataTemplate>
				</CollectionView.EmptyViewTemplate>
			</CollectionView>
		</RefreshView>
	</Grid>
</ContentPage>
